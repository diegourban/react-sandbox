<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Basic Example</title>
    <link rel="stylesheet" href="resources/css/base.css" />
  </head>
  <body>
    <h1>Basic Example</h1>
    <div id="container">
		<div id="my-component-without-jsx"></div>
		<div id="my-component"></div>
		<div id="my-component-es6"></div>
		<div id="my-component-es6-child"></div>
		<div id="my-component-es6-default-props"></div>
		<div id="mixins"></div>
		<div id="proptypes"></div>
		<div id="initial-state-lifecycle"></div>
		<div id="state-change-lifecycle"></div>
		<div id="props-change-lifecycle"></div>
    </div>
    <script src="https://fb.me/react-15.1.0.js"></script>
	<script src="https://fb.me/react-dom-15.1.0.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.24/browser.min.js"></script>
    <script type="text/babel">
		var ProductCategoryRow = React.createClass({
			render: function() {
				return (<tr><th>{this.props.category}</th></tr>);
			}
		});
		
		var ProductRow = React.createClass({
			render: function() {
				return (
					<tr>
						<td>{this.props.product.name}</td>
						<td>{this.props.product.price}</td>
					</tr>
				);
			}
		});
		
		var ProductTable = React.createClass({
			render: function() {
				var rows = [];
				this.props.products.forEach(function(product) {
					rows.push(<ProductRow product={product} key={product.name}/>);
				});
				
				return (
					<table>
						<thead>
							<tr>
								<td>Name</td>
								<td>Price</td>
							</tr>
						</thead>
						<tbody>{rows}</tbody>
					</table>
				);
			}
		});
		
		var FilterableProductTable = React.createClass({
			render: function() {
				return (
					<div>
						<ProductTable products={this.props.products}/>
					</div>
				);
			}
		});
		
		var PRODUCTS = [
		  {category: 'Sporting Goods', price: '$49.99', stocked: true, name: 'Football'},
		  {category: 'Sporting Goods', price: '$9.99', stocked: true, name: 'Baseball'},
		  {category: 'Sporting Goods', price: '$29.99', stocked: false, name: 'Basketball'},
		  {category: 'Electronics', price: '$99.99', stocked: true, name: 'iPod Touch'},
		  {category: 'Electronics', price: '$399.99', stocked: false, name: 'iPhone 5'},
		  {category: 'Electronics', price: '$199.99', stocked: true, name: 'Nexus 7'}
		];
		
		// render
		var MyComponent = React.createClass({
			render: function() {
				return (
					<div>
						{this.props.name}
					</div>
				);
			}
		});
		// render using ES6
		class MyComponentES6 extends React.Component{
			render() {
				return (
					<div>
						{this.props.name}
					</div>
				);
			}
		};
		
		// using count and map
		class MyComponentChild extends React.Component{
			render() {
				var count = React.Children.count(this.props.children);
				console.log(count);
				
				React.Children.map(this.props.children, function(child){
					console.log(child);
				});
				return (
					<div>
						{this.props.name} Child count: {count}
					</div>
				);
			}
		};
		
		// state and default props
		var GenericComponent = React.createClass({
			getInitialState: function() {
				return {thing: this.props.thingy};
			},
			getDefaultProps: function() {
				return {thingy: 'cheese'};
			},
			render: function() {
				return (
					<div>
						{this.state.thing}
					</div>
				);
			}
		});
		// state and default props using ES6
		class GenericComponentES6 extends React.Component{
			constructor(props) {
				super(props);
				this.state = {thing : props.thingy};
			}
			render() {
				return (
					<div>
						{this.state.thing}
					</div>
				);
			}
		};
		GenericComponentES6.defaultProps = {thingy : "GenericComponentES6 with default props"};
		
		// mixins
		var SetIntervalMixin = {
		  componentWillMount: function() {
			this.intervals = [];
		  },
		  setInterval: function() {
			this.intervals.push(setInterval.apply(null, arguments));
		  },
		  componentWillUnmount: function() {
			this.intervals.map(clearInterval);
		  }
		};
		
		var TickTock = React.createClass({
		  mixins: [SetIntervalMixin], // Use the mixin
		  getInitialState: function() {
			return {seconds: 0};
		  },
		  componentDidMount: function() {
			this.setInterval(this.tick, 1000); // Call a method on the mixin
		  },
		  tick: function() {
			this.setState({seconds: this.state.seconds + 1});
		  },
		  render: function() {
			return (
			  <p>
				React has been running for {this.state.seconds} seconds.
			  </p>
			);
		  }
		});
		
		//proptypes
		class MyComponentPropTypes extends React.Component {
			propTypes: {
				requiredName: React.PropTypes.string.isRequired,
				optionalBoolean: React.PropTypes.bool
			}
			constructor(props) {
				super(props);
				this.state = {thing : props.optionalBoolean};
			}
			render() {
				return (
					<div>
						{this.state.thing}
					</div>
				);
			}
		}
		
		// lifecycles
		
		var GenericComponentInitialRenderLifecycle = React.createClass({
			// Lifecycle during initial render: getInitialProps > getInitialState > componentWillMount > render > componentDidMount
			// first
			getInitialProps: function() {
				return {};
			},
			
			// second
			getInitialState: function() {
				return {};
			},
			
			// third
			componentWillMount: function() {
			
			},
			
			// render
			render: function() {
				return (<h1>Hello Initial State</h1>);
			},
			
			// finally
			componentDidMount: function() {
			
			}
		});
		
		var GenericComponentStateChangeLifecycle = React.createClass({
			// Lifecycle during state change: shouldComponentUpdate > componentWillUpdate > render > componentDidUpdate
			// first
			shouldComponentUpdate: function() {
			},
			
			// second
			componentWillUpdate: function() {
			},
			
			// render
			render: function() {
				return (<h1>Hello State Change</h1>);
			},
			
			// finally
			componentDidUpdate: function() {
			
			}
		});
		
		var GenericComponentPropsChangeLifecycle = React.createClass({
			// Lifecycle during state change: componentWillReceiveProps > shouldComponentUpdate > componentWillUpdate > render > componentDidUpdate
			// first
			componentWillReceiveProps: function(nextProps) {
			},
			
			// second
			shouldComponentUpdate: function(nextProps, nextState) {
				// if you want to prevent the component updating
				// return false;
				return true;
			},
			
			// third
			componentWillUpdate: function(nextProps, nextState) {
			},
			
			// render
			render: function() {
				return (<h1>Hello Props Change</h1>);
			},
			
			// finally
			componentDidUpdate: function() {
			
			}
		});
		
		
		// without JSX
		ReactDOM.render(React.createElement(MyComponent, {name: "MyComponent without JSX"}), document.getElementById('my-component-without-jsx'));
		
		// without ES6
		ReactDOM.render(<MyComponent name="MyComponent"/>, document.getElementById('my-component'));		
		
		// with JSX
		ReactDOM.render(<MyComponentES6 name="MyComponent with ES6"/>, document.getElementById('my-component-es6'));		
		
		// with 1 child
		ReactDOM.render(<MyComponentChild name="MyComponentES6 with child"> <p key="firsty">a child</p> </MyComponentChild>, document.getElementById('my-component-es6-child'));		
		
		ReactDOM.render(<GenericComponentES6 />, document.getElementById('my-component-es6-default-props'));
		
		ReactDOM.render(<TickTock />, document.getElementById('mixins'));
		
		ReactDOM.render(<MyComponentPropTypes optionalBoolean="21"/>, document.getElementById('proptypes'));
		
		// lifecycles teste
		ReactDOM.render(<GenericComponentInitialRenderLifecycle />, document.getElementById('initial-state-lifecycle'));
		ReactDOM.render(<GenericComponentStateChangeLifecycle />, document.getElementById('state-change-lifecycle'));	
		ReactDOM.render(<GenericComponentPropsChangeLifecycle />, document.getElementById('props-change-lifecycle'));
    </script>
  </body>
</html>
